United States COVID-19 Data Analysis
Alex Ripperton

Abstract
In our assessment of the United States COVID-19 data set we looked at what states and counties are being most affected by COVID. We looked for what factors may contribute to the amount of cases seen by each county and state. We also looked at what factors may cause those cases to have higher mortality rates. After our investigation of these questions we built a model that can predict the total cases and deaths seen by a state with 80 percent accuracy. 


Introduction
Given the current situation regarding COVID-19, our team felt that we wanted to spend our time modeling and assessing which factors make a population the most vulnerable in the face of this novel pandemic. After diving into the data, a few different features stood out as relevant including population density, quality of healthcare, social vulnerability, age, etc. We decided to separate our models into population predictions and resource predictions. Then combining the models to inform our predictions of the number of confirmed cases in a day. 

We then continued by creating visualizations that helped us understand what factors seemed to contribute the most to the number COVID cases in a particular area as well as the mortality rate that was seen in a given county or state. As a result we could use the factors that were shown to be correlated with increased COVID cases or COVID mortality to build a model that is able to predict the amount of COVID cases in a state as well as the number of deaths the state will see from COVID. 
Methods

For our first visualization that shows the relationship between average population density in a state and their rate of confirmed COVID-19 cases, a lot of data cleaning was necessary. First we grouped our county data by state and got rid of all the states that weren't also included in our confirmed cases data set. This way the tables had the same shape and there wasn’t any missing information. we then had to figure out the amount of counties in each individual state so that we could divide the summed avg population density of each county in order to get an average population density for the state. We also decided to drop all non-essential columns in order to make the data frame easier to work with. we used a bar plot to visualize this data because it does a good job of showing how strong the correlation is between population density and the number of COVID cases per capita 
For our second visualization we looked at mortality rate by state and how it was effect based on the amount of smokers in the state. The cleaning process for this visualization was a little bit unique in that we began the cleaning process by trying to make a visualization of the average number of ICU beds per state and how it related to COVID mortality but we found that this wasn’t a very useful visualizations due to the fact that each state had a relatively similar amount of beds per capita. So instead we switched to smoking rates and luckily most of the cleaning had already been done for the old ICU visualization. The overall cleaning process was similar to that of the first visualization where we used the grouped county data by state. Summed all the smoking rates and divided by the amount of counties to get an average amount of smoking by state. Then we found the number of confirmed cases by state and the number of confirmed deaths by state in order to get the mortality rate, and used a scatter plot to visualize my results.
For our third visualization, we were trying to demonstrate how different population types are experiencing the pandemic, specifically looking at mortality rate,  on a state-by-state basis. A significant indication of the status of a state is the rural-urban continuum code - this rates a county on a scale of 1-9 based on various factors with lower scores being more metropolitan. Additionally, we divided the different features of the counties dataframe into population type statistics (population density, smoker percentage, median age, etc.) and resource availability type statistics (hospitals, ICU beds, hospital hours, etc.) to see if there was a greater correlation with one or the other. This ultimately aims to answer the question of whether the medical resources available for a state or county have an impact on the response to COVID-19 or if the pre-existing population conditions determine the results. For this state based comparison, we needed to take the features of the county dataframe and convert them into either summed or weighted average features for each state. Smoker percentage, for example, would be weighted since a county with less residents should contribute less significantly to the state’s total smoker percentage. Population over 65, however, is obviously summed up from all of the counties before being normalized by the entire state population. Two functions were created to create these new features in the state dataframe and then 4 scatter plots were used to correlate rural-urban continuum code and mortality rate with different population type and resource availability type features. 
For our fourth visualization, we wanted to see how political affiliation correlated with mortality rate on a county basis. Republicans and Democrats have responded very differently to the pandemic and it would be interesting to see if that difference manifests itself in the data. Since the Democrat-Republican statistics were given as a ratio, we first mapped all of those results into a scale from 0-1 with seven divisions. Additionally, we had to add county-by-county mortality and case percentages to the county dataframe. After extracting and appending the most up-to=date totals from the mortality and confirmed case dataframes, the percentages could be calculated by dividing by the county population. Lastly, we chose to compare mortality rate with a population based statistic and resource based statistic - median age and hospital hours, respectively - to continue evaluating the contributions of each. A scatter plot was created with the color indicating the political affiliation.
For our fifth visualization, we wanted to test if there is correlation between Social Vulnerability index and mortality rates. On a scale of 0 to 1, SVI describes the resilience of a community when confronted by external stresses on public health. To prepare the data for this visualization, we had to calculate a COVID-19 death rate which is defined as the number of deaths / number of confirmed cases in a county. From here we extracted the SVI data from the counties data set and created a scatter plot comparing the two. We were unable to create a better system that accounted for population density and its effects on SVI, as we felt that there may be some socially vulnerable populations that are in more rural areas so have negligible confirmed cases as of the time of our data set which could skew the information. 
For our sixth visualization(s), we took advantage of pyplot’s choropleth map function which allows us to cast different data sets onto a geographical json of all the counties in the United States, displaying it in a very attractive and easy to understand manner. We felt that this would be the best way to display different statistical information with more of an impact on the reader. In order to format the maps properly, we first had to create a new dataframe called map_data which includes the various information we care about for each county included in the county_json. For simplicity, the map does not include data beyond the lower 48 states and we had to factor that out while cleaning the data. Additionally, our county FIPS data was created as an int, while the base json requires a string, so we had to cast it as such. Doing this caused an issue when casting the FIPS onto the geo data, because the first 9 counties began with 1, 2, 3 rather than 01, 02, 03. Once we recognized this trend, we created a cleaning function which appended a 0 to the beginning of every string that was in the first subset of states which were not showing up. 
For our model, we created several versions of the same general linear regression model predicting confirmed cases and deaths on a state basis. The idea was to predict cases based solely on resource availability, solely on population type, and then with both to compare the contributions and significance of each amidst the pandemic.


Results
Fig 1.	Avg Population Density of  a state versus the percent of the state that is positive for COVID-19	

	The results that we can take away from our first visualization is that there is a strong correlation between the number of confirmed COVID cases by state per capita and the average population density of the state. This correlation is consistent with the anecdotal stories that have been surrounding the virus, Things like how big cities are being hit much harder than rural communities. This was a somewhat expected result of this given investigation based on what we know about viruses but it was nice to confirm our hypothesis that population dense regions are generally more susceptible to large COVID outbreaks. As a result of this visualization we knew that it would be greatly beneficial to us to include a feature in our model that took into account the population density of a state when trying to predict the total number of cases the state will see. 



Fig 2. Scatter plot of the percent of state population that smokes versus the states COVID Mortality rate

Our second visualization had more unexpected results than our first. We saw no strong correlation between the COVID-19 mortality rate in a state and the amount of smokers per capita in that state. This was surprising because COVID is a respiratory illness and we had heard that smoking likely plays a role in whether or not someone will be seriously affected by the virus. It is possible that other factors may be playing a larger role which results in the smoker data not being a significant factor. As a result of this discovery we opted to not use smoking data as a factor when training our model to predict the number of deaths in a state. It would have been detrimental to our model to put smoking data by state in as a feature because there are no clear correlations between the smoking data and the COVID mortality rates. We chose a scatter plot to visualize this particular set of data because we thought it nicely showed the lack of correlation between our two variables that we were investigating. 















Figure 3: Mortality rate (color) and rural-urban continuum code (size) correlations with various state-averaged features. The upper plots compare resource allocation (hospitals vs. ICU beds, Medicare vs. M.D.s) and the lower plots compare population type (smoker percentage vs. respiratory mortality rate, SVI vs. population density).
Some strong correlations were established through our third visualization. Across all of the plots (Figure 3), it’s apparent that more urban states (larger points) experience higher mortality rates, which is to be expected. Starting from the top left, there there is a somewhat strong correlation between the ICU beds and hospitals and the state mortality rate - as expected, having fewer hospitals and fewer ICU beds tends to lead to a higher mortality rate with a stronger correlation with the number of hospitals. Additionally, it’s notable that more urban states have less resources per capita. Rural states might have fewer medical resources overall, but have smaller populations to serve. Moving to the top right, there seems to be a negative relationship between M.D.’s per capita and mortality rate - with the highest mortality rates occurring in states with more M.D.s per capita. This could be due to the fact that counties with greater need - more vulnerable counties - require more doctors. There is no clear correlation with Medicare enrollment and mortality rate, however. Looking at the population type comparison in the bottom left, there is a clear positive correlation between smoker percentage and respiratory mortality rate. This is to be expected. However, there is not a strong correlation with either of these features and the mortality rate despite the fact that people with respiratory problems are more vulnerable. Lastly, the bottom right plot shows a strong positive correlation between population density and both rural-urban continuum code and mortality rate. This is to be expected since urban counties have higher population densities and the spread of COVID-19 is more prevalent in higher population density states. There was no strong correlation between social vulnerability and mortality rate, however. This was surprising since we expected more vulnerable populations to have higher mortality rates in the pandemic. Overall, there were some clear relationships established through this plot, but it’s unclear whether resources or population type play a bigger role in mortality rate.
Fig 4: Confirmed case and death count correlations with median age and hospital hours by political affiliation.
For our fourth visualization, the relationship between case and death rates and political affiliation was made clear - more democratic counties are experiencing both higher case rates and death rates. However, this could be explained by the fact that counties with higher population densities - more urban populations - are typically more democratic and thus more susceptible to the spread of COVID-19.  Starting from the median age plots on the left, it’s interesting that counties with an older median age are not more susceptible to higher death rates. This would be expected since older people are more vulnerable to the effects of COVID-19, but counties with a median age between 35 and 40 appear to be the most affected. Additionally, these plots demonstrate that Republican counties typically have a higher median age, which is to be expected. As for the hospital hour plots on the right, it’s clear that Democratic counties have more hospital resources available. However, these same counties seem to be the ones with the highest confirmed case and death rates. Additionally, there is a slight correlation between increased hospital hours and reduced case and death rate, indicating that resource availability does have an effect on a county’s response to the pandemic. Overall, this plot demonstrates the relationship between political affiliation and the effect of COVID-19, while providing greater insight into the comparable effects of resources and population type.
Fig 5.1 Mortality rate per 1000 individuals 
Fig 5.2 Mortality rate per number of confirmed cases 

For our fifth visualization, by plotting out the mortality rates on a per capita basis, we wanted to understand if there was any sort of trend between my earlier observations regarding SVI, population and confirmed cases. Based on the data observed here, it didn't reveal any trends. Further explanation would require me to better account for population density, speed of transmission and other health correlations. However, when we adjusted the mortality rate of COVID-19 to be the number of deaths / number of cases and cast it onto SVI, there is clearly a greater threat once SVI surpasses 0.6. Social vulnerability refers to the resilience of communities when confronted by external stresses on human health, an SVI rising above 0.6 suggests high risk. Recognizing that socially vulnerable communities are most at risk in the face of coronavirus can help policymakers as they try to figure out how to properly allocate resources across the country. Reducing social vulnerability can decrease both human suffering and economic loss, it is important to work on improving outcomes as they face higher death rates.
Please see below for visualization 6. Through these maps of the United States, our team hopes to show the disparity of COVID-19 cases throughout the differing population and resource makeups of the United States. Fig 6.1 shows the amount of confirmed cases, with yellow meaning 100+ cases. It connects closely with Fig 6.3 where higher population density leads to more confirmed cases. This further connects with Fig 6.2 and political affiliation as typically more densely populated counties lean more liberal in affiliation. However, we were hoping Figure 6.4 would provide more insight into social vulnerability of a county (and in connection with poorer health care opportunities) by connecting with Fig 6.1 confirmed cases. The choropleth map technique felt like the most visually effective way to convey many different forms of information. Humans are good at understanding numbers, but seeing the data in a form of something familiar to us (like a map) and applying coloring techniques hopefully helps evoke a deeper understanding of the situation we all currently face.  



Model
Confirmed Case Prediction
Deaths Prediction


Training %
Test %
Training %
Test %
Population
97.64
72.73
97.27
79.86
Resource
20.86
46.13
13.99
46.22
Combined
97.75
71.69
97.37
79.49


For our linear regression model, it was made clear that population type was much more effective in predicting cases and deaths in each state. The model including both resource allocation and population type features was not even the most effective, at 98% and 97% training accuracy and 72% and 79% test accuracy for cases and deaths respectively. While the population-only model was able to achieve 98% and 97% training accuracy and 73% and 80% test accuracy for cases and deaths respectively, the resource availability-only model was able to achieve just 21% and 14% training accuracy and 46% and 46% test accuracy for cases and deaths respectively - ultimately reducing the effectiveness of the combined model. Clearly, the population type of a state is much more telling of how COVID-19 will affect the population. In the early stages of the pandemic, this shouldn’t be too surprising. Regardless of the resources available to the population of a state, there was so much unknown in the beginning of the COVID-19 pandemic that neither populations or medical resources could respond effectively enough. The populations were made susceptible to the spread of the virus and hospitals were scrambling to respond.
Discussion

We found many interesting features for predicting the number of COVID infections as well as the mortality rate for these COVID infections. The two that we found the most interesting were Population density and smoking rates. We found population density as an extremely useful tool for predicting the number of COVID cases in a given state. We thought that smoking rates would be one of our most useful predictors for COVID mortality but interestingly this was not the case, and other factors seemed to play a much stronger role like median age. 

	We found that cleaning the data at times was difficult especially with the county data. We had a hard time getting the confirmed case data and the death data to have the same counties in the same order as the county data. This is partially why we decided to make a lot of our data analysis at a state level because it was much easier to group by state and get the different data tables to match up in length and order so you can merge them. Additionally we found building our own model from scratch quite difficult just because we hadn’t had to do that completely on our own yet. 

Ethically we tried to stay conscious of the fact that these mortality rates aren’t just random data points. They were losses of human life which is not something that is to be taken lightly.

If we had data on other countries' infection and mortality rates we could test a different hypothesis testing whether or not it is likely that China is misreporting many of its case and mortality numbers. Ethically we feel like we would have an obligation to try and go into the data analysis with an open mind and go in the preconceived notions about whether or not china was accurately reporting its cases. we feel like this would be critical in being able to come up with an accurate result. 



Conclusion

	We did a lot of grouping data by state because it was very challenging to work with the county data at times because the counties were quite different among the different tables that we were provided with. This may have led to some limitations in our ability to make predictions at a smaller scale or have more training points for a model to learn from. Some future work that we are thinking about pursuing is maybe doing some similar data analysis on a more updated corona set potentially one that has other countries data in it as well. A question that we were interested in approaching for future work was looking at how chinas infection rate compares to those of other countries and see if they are at all similar because china has been claiming a pretty shockingly low amount of cases and fatalities considering that it started there.
